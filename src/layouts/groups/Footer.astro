---
import { currentLocale, useI18n } from "astro-nanostores-i18n:runtime";
import { version } from "../../../package.json";
import { params } from "@nanostores/i18n";
import Sprite from "../../components/Sprite.astro";
import { C } from "../../site.config";
import Contact from "./Contact.astro";
import { prepareNavigation } from "../../utils/paths";
import Navigation from "../../components/Navigation.astro";
import Address from "./Address.astro";

const locale = currentLocale.get();
const navigation = await prepareNavigation(`footer/${locale}`);
const messages = useI18n("layouts/groups/Footer.astro", {
  copyright: "Â© 2025 openscript GmbH",
  version: params("Version {version}"),
});
---

<footer>
  <Sprite class="arrow" name="arrow" />
  <div class="contact">
    <Address />
    <Contact withoutLanguageSwitcher />
  </div>
  <span class="copyright">{messages.copyright}<br />{messages.version({ version })}</span>
  <div class="links">
    <nav>
      <Navigation items={navigation} />
    </nav>
    <a href={C.SETTINGS.META.LINKEDIN} target="_blank" rel="noopener" aria-label="LinkedIn">
      <Sprite name="linkedin" />
    </a>
    <a href={C.SETTINGS.META.GITHUB} target="_blank" rel="noopener" aria-label="GitHub">
      <Sprite name="github" />
    </a>
  </div>
</footer>

<style>
  footer {
    display: grid;
    grid-template-columns: min-content 1fr 1fr;
    grid-template-areas:
      "arrow contact links"
      "copyright copyright copyright";
    gap: var(--size-gutter-big);
    background-color: var(--color-primary);
    padding-block: var(--size-gutter-big);

    .arrow {
      grid-area: arrow;
      fill: var(--color-secondary);
      height: auto;
      width: 4rem;
      transform: rotate(300deg) translateX(-0.7rem);
    }

    .contact {
      grid-area: contact;
      align-self: flex-end;
      display: flex;
      gap: var(--size-gutter-big);

      ul {
        list-style: none;
        margin: 0;
        padding: 0;
      }
    }

    .links {
      grid-area: links;
      justify-content: flex-end;
      align-self: flex-end;
      display: flex;
      gap: var(--size-gutter-big);
      width: 100%;

      svg {
        fill: var(--color-background);
        width: 2.4rem;
      }
    }

    .copyright {
      grid-area: copyright;
      text-align: center;
      font-size: 0.8rem;
      color: var(--color-background);
    }
  }

  @media screen and (max-width: 800px) {
    footer {
      grid-template-areas:
        "contact"
        "links"
        "copyright";
      grid-template-columns: repeat(1, 1fr);

      .arrow {
        display: none;
      }

      .contact,
      .links {
        margin: 0 auto;
        justify-content: center;
      }
    }
  }
</style>
